'use strict';

function extractFrames(doc = document) {
  return [...doc.querySelectorAll('iframe[src]:not([src=""])')]
    .map(srcEl => {
      try {
        const contentDoc = srcEl.contentDocument;
        return (
          contentDoc &&
          /^https?:$/.test(contentDoc.location.protocol) &&
          contentDoc.defaultView &&
          contentDoc.defaultView.frameElement &&
          contentDoc
        );
      } catch (err) {
        //for CORS frames
      }
    })
    .filter(x => !!x);
}

module.exports = extractFrames;
