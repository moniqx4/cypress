'use strict';
const uniq = require('./uniq');

function makeExtractResourceUrlsFromStyleTags(extractResourcesFromStyleSheet) {
  return function extractResourceUrlsFromStyleTags(doc) {
    return uniq(
      [...doc.getElementsByTagName('style')].reduce((resourceUrls, styleEl) => {
        const styleSheet = [...doc.styleSheets].find(
          styleSheet => styleSheet.ownerNode === styleEl,
        );
        return resourceUrls.concat(extractResourcesFromStyleSheet(styleSheet, doc.defaultView));
      }, []),
    );
  };
}

module.exports = makeExtractResourceUrlsFromStyleTags;
